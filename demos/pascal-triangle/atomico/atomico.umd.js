!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.atomico={})}(this,function(t){"use strict";const e="element-collect",s="element-master",n="element-context";function i(t){return t.shadowRoot||t}function r(t,e){i(t).removeChild(e)}function o(t,e){i(t).appendChild(e)}function l(t,e,...s){return new c(t,e,function t(e,s=[]){for(let n=0;n<e.length;n++){let i=e[n];Array.isArray(i)?t(i,s):s.push(h(i)?i:new c("",{},[i||""]))}return s}(s))}class c{constructor(t,e,s){this.tag=t,this.props=e||{},this.children=s||[]}clone(t=this.tag,e=this.props,s=this.children){return new c(t,Object.assign({},e),s)}}function h(t){return"object"==typeof t&&t instanceof c}function a(t,l,h,p={},d,f){let g=l&&l[s]||new Map,m=g.get(t)||new c,y=l,b=h,v="slot"===h.tag;if(h=u(h,p),m=u(m,p),f=f||"svg"===h.tag,t&&m.tag!==h.tag)if(y=null!==(C=h.tag)&&"object"==typeof C&&11!==C.nodeType?h.tag:h.tag?f?document.createElementNS("http://www.w3.org/2000/svg",h.tag):document.createElement(h.tag):document.createTextNode(""),l){!function(t,e,s){i(t).replaceChild(e,s)}(t,y,l);let e=h.children.length;for(;!v&&!h.collect&&l.firstChild;){if(e--)return;o(y,l.firstChild)}}else o(t,y);var C;if(h.tag){y&&y[n]&&(d=y[n](d));let s=t&&y[e]||{},o=function(t,e,s,n,i){let r=Object.keys(e).concat(Object.keys(s)),o=r.length,l={};for(let c=0;c<o;c++){let o=r[c];if((!n||"xmlns"!==o)&&e[o]!==s[o]){if(i&&i.indexOf(o)>-1){l[o]=s[o];continue}let r="function"==typeof s[o],c="function"==typeof e[o];if(r||c)c&&t.removeEventListener(o,e[o]),r&&t.addEventListener(o,s[o]);else if(o in s)if(o in t&&!n||n&&"style"===o)if("style"===o)if("object"==typeof s[o]){let n=e[o]||{},i=s[o];for(let e in i)n[e]!==i[e]&&("-"===e[0]?t.setProperty(e,i[e]):t.style[e]=i[e]);s[o]=Object.assign({},n,i)}else t.style.cssText=s[o];else t[o]=s[o];else n?t.setAttributeNS(null,o,s[o]):t.setAttribute(o,s[o]);else i?s[o]=e[o]:t.removeAttribute(o)}}return l}(y,h.tag===m.tag?m.props:{},h.props,f,s.props);if(s.handler)o.children=h.children.map(t=>t.tag?t:t.children[0]),s.handler(o);else if(!v&&y){let e=Array.from(i(y).childNodes),s=h.children,n=Math.max(s.length,h.children.length);for(let i=0;i<n;i++)s[i]?a(y,e[i],s[i],p,d,f):e[i]&&r(t,e[i])}}else m.children[0]!==h.children[0]&&(y.textContent=h.children[0]);return y[s]=g.set(t,b),y}function p(t,s,n){this.observer=t[e]={props:s,handler:n}}function d(t,e,s="context"){t[n]=(n=>t[s]=e(n)||n)}function u(t,e){return"slot"===t.tag?(delete(t=t.clone(e[t.props.name]||"")).props.name,t):t}function f(t){return Promise.resolve().then(t)}function g(t){let e=Array.isArray(t);return{keys:(e?t:Object.keys(t)).concat("children"),types:e?{}:t}}t.Element=class extends HTMLElement{constructor(){super(),this.props={},this.slots={},this.state={},this.preventRender=!0,this.is=this.nodeName.toLocaleLowerCase(),this._props=g(this.constructor.props),new p(this,this._props.keys,t=>this.setProperties(t)),new d(this,t=>this.getContext(t))}get content(){return this.shadowRoot||this}static get props(){return[]}static get observedAttributes(){return g(this.props).keys}setAttribute(t,e){this._props.keys.indexOf(t)>-1?this.setProperties({[t]:e}):super.setAttribute(t,e)}setProperties(t){let e={},s=this.isMounted;for(let s in t){let n,i=this._props.types[s],r=t[s];r=i?i(r):r,n=s.replace(/-+([\w])/g,(t,e)=>e.toUpperCase()),r!==this.props[n]&&(e[n]=r)}Object.keys(e).length&&(s&&(s=!1!==this.onUpdate(e)),this.props=Object.assign({},this.props,e),s&&this.setState({}))}setState(t,e){"object"==typeof t&&(this.state=Object.assign({},this.state,t),this.preventRender||(this.preventRender=!0,f(()=>{let t=this.render();a(!1,this,(t=h(t)&&"host"===t.tag?t:l("host",{},t)).clone(this.is),this.slots,this.context),this.preventRender=!1,e?e():this.onUpdated()})))}connectedCallback(){f(()=>{let t=document.createDocumentFragment();for(;this.firstChild;){let e=this.firstChild,s=e.getAttribute&&e.getAttribute("slot");s&&(this.slots[s]=e),t.appendChild(e)}this.preventRender=!1,this.setState({},()=>{this.isMounted=!0,this.onMounted()})})}disconnectedCallback(){this.onUnmounted()}attributeChangedCallback(t,e,s){e!==s&&this.setProperties({[t]:s})}dispatch(t,e){this.dispatchEvent(new CustomEvent(t,{detail:e}))}getContext(){}onMounted(){}onUpdate(){}onUnmounted(){}onUpdated(){}render(){}},t.h=l,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=atomico.umd.js.map
